<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stream & Dream | Premium Men's Wear</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #000000;
            --accent: #0071e3;
            --bg: #fbfbfd;
            --white: #ffffff;
            --gray-100: #f5f5f7;
            --gray-200: #e8e8ed;
            --gray-400: #86868b;
            --gray-600: #424245;
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
            --shadow-lg: 0 20px 40px rgba(0,0,0,0.08);
            --radius-xl: 28px;
            --radius-lg: 18px;
            --radius-md: 12px;
            --transition-premium: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Plus Jakarta Sans', sans-serif;
            -webkit-font-smoothing: antialiased;
            -webkit-tap-highlight-color: transparent;
            scrollbar-width: none;
        }
        *::-webkit-scrollbar { display: none; }

        body {
            background-color: var(--bg);
            color: var(--primary);
            overflow-x: hidden;
            padding-bottom: 90px;
        }

        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .flex { display: flex; }
        .grid { display: grid; }
        .justify-between { justify-content: space-between; }
        .items-center { align-items: center; }
        .hidden { display: none !important; }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 64px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: saturate(180%) blur(20px);
            z-index: 1000;
            border-bottom: 1px solid var(--gray-200);
        }
        .nav-inner { height: 100%; display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 18px; font-weight: 800; letter-spacing: -0.5px; text-transform: uppercase; cursor: pointer; }
        
        .nav-links { display: none; gap: 32px; }
        @media (min-width: 768px) { .nav-links { display: flex; } }
        .nav-links a { text-decoration: none; color: var(--primary); font-size: 13px; font-weight: 600; opacity: 0.7; transition: 0.2s; }
        .nav-links a:hover { opacity: 1; color: var(--accent); }

        .cart-trigger { position: relative; cursor: pointer; padding: 8px; }
        .badge { position: absolute; top: 0; right: 0; background: var(--accent); color: white; font-size: 9px; font-weight: 800; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }

        /* Views */
        .section-view { padding-top: 80px; min-height: 100vh; animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Hero */
        .hero { padding: 40px 0 20px; text-align: center; }
        .hero h1 { font-size: clamp(32px, 8vw, 64px); font-weight: 800; letter-spacing: -2px; line-height: 1.1; margin-bottom: 12px; }
        .hero p { font-size: 18px; color: var(--gray-400); max-width: 500px; margin: 0 auto; }

        /* Filter Panel (Slide-in) */
        #filter-panel {
            position: fixed; top: 0; right: -100%; width: 400px; height: 100vh;
            background: white; z-index: 2000; transition: var(--transition-premium);
            box-shadow: -20px 0 60px rgba(0,0,0,0.1); padding: 40px;
        }
        #filter-panel.active { right: 0; }
        @media (max-width: 500px) { #filter-panel { width: 100%; } }
        .filter-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; }
        .filter-group { margin-bottom: 30px; }
        .filter-group label { display: block; font-size: 12px; font-weight: 800; text-transform: uppercase; color: var(--gray-400); margin-bottom: 15px; }

        /* Product Grid */
        .product-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 60px; }
        @media (min-width: 768px) { .product-grid { grid-template-columns: repeat(4, 1fr); gap: 30px; } }

        .product-card {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: 12px;
            transition: var(--transition-premium);
            border: 1px solid rgba(0,0,0,0.02);
            position: relative;
            cursor: pointer;
        }
        .product-card:hover { transform: translateY(-8px); box-shadow: var(--shadow-lg); }
        .card-img { width: 100%; aspect-ratio: 1/1.2; border-radius: var(--radius-lg); background: var(--gray-100); overflow: hidden; margin-bottom: 12px; }
        .card-img img { width: 100%; height: 100%; object-fit: cover; transition: 0.6s; }
        .product-card:hover .card-img img { transform: scale(1.1); }
        .tag { position: absolute; top: 24px; left: 24px; background: #ff3b30; color: white; font-size: 10px; font-weight: 800; padding: 4px 10px; border-radius: 8px; text-transform: uppercase; z-index: 2; }

        .card-info h3 { font-size: 15px; font-weight: 700; margin-bottom: 4px; }
        .card-info p { font-size: 12px; color: var(--gray-400); margin-bottom: 12px; line-height: 1.4; height: 34px; overflow: hidden; }
        .price-row { display: flex; align-items: center; gap: 8px; }
        .price { font-size: 17px; font-weight: 800; }
        .old-price { font-size: 13px; color: var(--gray-400); text-decoration: line-through; }

        /* Product Detail View (Fixed Full Screen Overlay for Mobile feel) */
        .full-detail-view {
            position: fixed; inset: 0; background: white; z-index: 3000;
            display: none; overflow-y: auto; padding-top: 20px; padding-bottom: 100px;
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .detail-layout { display: grid; grid-template-columns: 1fr; gap: 40px; margin-top: 20px; }
        @media (min-width: 768px) { .detail-layout { grid-template-columns: 1.2fr 1fr; gap: 60px; } }
        
        .gallery-main { width: 100%; aspect-ratio: 1/1.2; border-radius: var(--radius-xl); overflow: hidden; background: var(--gray-100); }
        .gallery-main img { width: 100%; height: 100%; object-fit: cover; }
        .gallery-thumbs { display: flex; gap: 12px; margin-top: 15px; overflow-x: auto; padding-bottom: 5px; }
        .thumb { width: 75px; height: 95px; border-radius: 12px; overflow: hidden; cursor: pointer; border: 2.5px solid transparent; flex-shrink: 0; transition: 0.3s; }
        .thumb.active { border-color: var(--accent); }
        .thumb img { width: 100%; height: 100%; object-fit: cover; }

        .detail-info h1 { font-size: clamp(28px, 4vw, 42px); font-weight: 800; letter-spacing: -1.5px; margin-bottom: 10px; line-height: 1; }
        .detail-price { font-size: 28px; font-weight: 800; margin-bottom: 24px; color: var(--accent); }
        .detail-desc { color: var(--gray-600); line-height: 1.7; margin-bottom: 30px; font-size: 16px; }
        
        .size-grid { display: flex; gap: 10px; margin-bottom: 35px; flex-wrap: wrap; }
        .size-box { width: 56px; height: 56px; border-radius: 16px; border: 1.5px solid var(--gray-200); display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 14px; cursor: pointer; transition: 0.2s; }
        .size-box.active { background: var(--primary); color: white; border-color: var(--primary); }
        
        .add-btn-large { width: 100%; padding: 22px; background: var(--primary); color: white; border-radius: 22px; border: none; font-size: 16px; font-weight: 800; cursor: pointer; transition: 0.3s; letter-spacing: 1px; text-transform: uppercase; }
        .add-btn-large:hover { background: var(--accent); transform: scale(1.02); }

        /* Checkout Form View */
        .checkout-view { display: none; margin-top: 40px; animation: fadeIn 0.5s ease; }
        .checkout-card { background: var(--gray-100); padding: 32px; border-radius: 30px; border: 1px solid var(--gray-200); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-size: 11px; font-weight: 800; text-transform: uppercase; color: var(--gray-400); margin-bottom: 8px; }
        .form-input { width: 100%; padding: 16px 20px; border-radius: 16px; border: 1.5px solid var(--gray-200); background: white; outline: none; font-size: 14px; font-weight: 700; transition: 0.3s; }
        .form-input:focus { border-color: var(--accent); }

        /* Reviews */
        .reviews-section { margin-top: 80px; padding-top: 60px; border-top: 1px solid var(--gray-200); }
        .review-card { background: white; padding: 28px; border-radius: 24px; margin-bottom: 24px; border: 1px solid var(--gray-100); }
        .rev-header { display: flex; align-items: center; gap: 15px; margin-bottom: 18px; }
        .rev-avatar { width: 48px; height: 48px; border-radius: 50%; overflow: hidden; background: var(--gray-200); }
        .rev-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .rev-name { font-weight: 800; font-size: 15px; }

        /* Tracking Bar */
        .track-card { background: white; padding: 30px; border-radius: 28px; border: 1px solid var(--gray-200); margin-bottom: 24px; }
        .track-progress { height: 6px; background: var(--gray-100); border-radius: 10px; margin: 30px 0; position: relative; overflow: hidden; }
        .track-fill { height: 100%; background: var(--accent); width: 0%; transition: 1.5s ease-in-out; border-radius: 10px; }
        .track-labels { display: flex; justify-content: space-between; }
        .track-step { font-size: 10px; font-weight: 800; color: var(--gray-400); text-transform: uppercase; letter-spacing: 0.5px; }
        .track-step.active { color: var(--accent); }

        /* Suggested Grid */
        .suggested-section { margin-top: 80px; }
        .section-title { font-size: 24px; font-weight: 800; margin-bottom: 30px; letter-spacing: -0.5px; }

        /* Bag Tab */
        .bag-item { display: flex; gap: 20px; padding: 20px; background: white; border-radius: 24px; border: 1px solid var(--gray-100); margin-bottom: 16px; }
        .bag-item img { width: 85px; height: 110px; border-radius: 16px; object-fit: cover; }
        .remove-btn { color: #ff3b30; font-size: 11px; font-weight: 800; cursor: pointer; background: none; border: none; margin-top: 10px; }

        /* Bottom Tab Nav Mobile */
        .mobile-nav { position: fixed; bottom: 20px; left: 20px; right: 20px; height: 72px; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); border-radius: 36px; display: flex; justify-content: space-around; align-items: center; z-index: 1100; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        @media (min-width: 768px) { .mobile-nav { display: none; } }
        .m-nav-item { color: white; opacity: 0.5; display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer; text-decoration: none; }
        .m-nav-item.active { opacity: 1; color: var(--accent); }
        .m-nav-item span { font-size: 9px; font-weight: 800; text-transform: uppercase; }

        .toast { position: fixed; bottom: 110px; left: 50%; transform: translateX(-50%) translateY(100px); background: var(--primary); color: white; padding: 14px 28px; border-radius: 16px; font-weight: 800; font-size: 13px; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 5000; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .toast.show { transform: translateX(-50%) translateY(0); }
        
        /* Search Bar Styles */
        .search-container { position: relative; flex: 1; max-width: 400px; margin: 0 30px; }
        .search-input { width: 100%; background: var(--gray-100); border: none; padding: 10px 20px 10px 45px; border-radius: 20px; font-weight: 600; outline: none; font-size: 14px; }
        .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--gray-400); }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.11.0",
    "@google/genai": "https://esm.sh/@google/genai@^1.34.0"
  }
}
</script>
</head>
<body class="no-scrollbar">

    <!-- Navbar -->
    <nav>
        <div class="container nav-inner">
            <div class="logo" onclick="navigateTo('shop')">STREAM & DREAM</div>
            
            <div class="search-container hidden md:flex">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                <input type="text" class="search-input" placeholder="Search premium matrix..." oninput="handleSearch(this.value)">
            </div>

            <div class="nav-links">
                <a href="#" onclick="navigateTo('shop')">Studio</a>
                <a href="#" onclick="navigateTo('orders')">Tracking</a>
                <a href="#" onclick="navigateTo('profile')">Identify</a>
            </div>
            <div class="cart-trigger" onclick="navigateTo('bag')">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
                <span class="badge" id="bag-count">0</span>
            </div>
        </div>
    </nav>

    <!-- SHOP VIEW -->
    <section id="shop-view" class="section-view container">
        <div class="hero reveal">
            <h1>Curated Essentials.</h1>
            <p>High-end men's wear engineered for the modern dreamer matrix.</p>
        </div>

        <div class="flex justify-between items-center" style="margin-bottom: 30px;">
            <div style="background: white; padding: 12px 24px; border-radius: 20px; border: 1px solid var(--gray-200); font-weight: 800; font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 10px;" onclick="toggleFilterPanel()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M4 21v-7m0-4V3m8 18v-9m0-4V3m8 18v-5m0-4V3M1 14h6m2-6h6m2 8h6"/></svg>
                FILTER MATRIX
            </div>
        </div>

        <div class="product-grid" id="product-grid">
            <!-- Items injected by JS -->
        </div>
    </section>

    <!-- FILTER PANEL -->
    <div id="filter-panel">
        <div class="filter-header">
            <h3 style="font-weight: 800; font-size: 20px;">Filters</h3>
            <div style="cursor: pointer; font-size: 24px;" onclick="toggleFilterPanel()">&times;</div>
        </div>
        <div class="filter-group">
            <label>Price Range</label>
            <input type="range" id="f-price" min="0" max="5000" step="100" style="width: 100%; accent-color: black;" oninput="updateRangeLabel(this.value)">
            <div style="display: flex; justify-content: space-between; font-size: 11px; font-weight: 800; margin-top: 8px;">
                <span>₹0</span>
                <span id="f-price-val">₹5000</span>
            </div>
        </div>
        <div class="filter-group">
            <label>Style Category</label>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="size-box" id="btn-tshirt" onclick="setFilterType('T-Shirt', this)">T-Shirts</button>
                <button class="size-box" id="btn-shirt" onclick="setFilterType('Shirt', this)">Shirts</button>
                <button class="size-box active" id="btn-all" onclick="setFilterType('All', this)">All</button>
            </div>
        </div>
        <div class="filter-group">
            <label>Color Node</label>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <div onclick="setFilterColor('White', this)" class="size-box" style="background:#fff; border:1px solid #ddd;">W</div>
                <div onclick="setFilterColor('Black', this)" class="size-box" style="background:#000; color:#fff; border:none;">B</div>
                <div onclick="setFilterColor('All', this)" class="size-box active">All</div>
            </div>
        </div>
        <button class="add-btn-large" style="margin-top: 20px;" onclick="applyFilterPulse()">Apply Matrix</button>
    </div>

    <!-- PRODUCT DETAIL VIEW -->
    <div id="full-detail-modal" class="full-detail-view">
        <div class="container">
            <div onclick="closeDetail()" style="cursor: pointer; display: flex; align-items: center; gap: 10px; margin-bottom: 30px; font-weight: 800; font-size: 13px; text-transform: uppercase; color: var(--gray-400);">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                Back to Studio
            </div>
            
            <div id="detail-content">
                <!-- Dynamic detail injected -->
            </div>

            <!-- ENHANCED PRODUCT DETAIL VIEW (BELOW CONTENT) -->
            <div id="enhanced-footer-view">
                <div id="checkout-section" class="checkout-view">
                    <div class="checkout-card">
                        <h2 style="font-size: 28px; font-weight: 800; margin-bottom: 12px; letter-spacing: -1px;">Shipping Logic</h2>
                        <p style="color: var(--gray-400); font-weight: 600; font-size: 14px; margin-bottom: 30px;">Verify node address before dispatch.</p>
                        <form id="order-form">
                            <div class="form-group">
                                <label>Identity</label>
                                <input type="text" class="form-input" id="ship-name" value="Apurv Vala" readonly>
                            </div>
                            <div class="form-group">
                                <label>Pulse Node</label>
                                <input type="text" class="form-input" id="ship-phone" value="+91 1234567890" readonly>
                            </div>
                            <div class="form-group">
                                <label>Delivery Coordinates</label>
                                <textarea class="form-input" id="ship-address" rows="3" style="resize:none;" placeholder="Enter specific node address...">C-15, Maruti-2, Singarva, Ahmedabad – 382430</textarea>
                            </div>
                            <button type="submit" class="add-btn-large" style="background: var(--accent);">Confirm Transmission (COD)</button>
                        </form>
                    </div>
                </div>

                <div class="reviews-section" id="reviews-hook">
                    <h2 class="section-title">Client Feedback</h2>
                    <div id="reviews-container">
                        <!-- Dynamic hardcoded review -->
                        <div class="review-card">
                            <div class="rev-header">
                                <div class="rev-avatar"><img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Apurv"></div>
                                <div>
                                    <div class="rev-name">Apurv Vala</div>
                                    <div style="color:#ff9500; font-size:10px;">★★★★★</div>
                                </div>
                            </div>
                            <p style="font-size:14px; line-height:1.6; color:var(--gray-600);">Exceptional weave quality. The matrix fit is precisely as described. A luxury pulse for my wardrobe. The shipping was prompt and the packaging felt truly premium.</p>
                        </div>
                    </div>
                </div>

                <div class="suggested-section">
                    <h2 class="section-title">Matrix Suggested</h2>
                    <div class="product-grid" id="suggested-grid">
                        <!-- Suggestions -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- BAG VIEW -->
    <section id="bag-view" class="section-view container hidden">
        <h2 style="font-size: 32px; font-weight: 800; margin-bottom: 30px; letter-spacing: -1.5px;">Bag Workspace</h2>
        <div id="bag-items">
            <!-- Items -->
        </div>
        <div id="bag-empty" class="hidden" style="text-align: center; padding: 100px 0; color: var(--gray-400); font-weight: 700;">Your matrix is empty.</div>
    </section>

    <!-- ORDERS VIEW -->
    <section id="orders-view" class="section-view container hidden">
        <h2 style="font-size: 32px; font-weight: 800; margin-bottom: 40px; letter-spacing: -1.5px;">Active Tracking</h2>
        <div id="orders-list">
            <!-- Tracking items -->
        </div>
    </section>

    <!-- PROFILE VIEW -->
    <section id="profile-view" class="section-view container hidden">
        <div style="text-align: center; padding: 40px 0;">
            <div style="width: 120px; height: 120px; background: var(--gray-100); border-radius: 50%; margin: 0 auto 25px; overflow: hidden; border: 4px solid white; box-shadow: var(--shadow-sm);">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Apurv" style="width:100%; height:100%;">
            </div>
            <h2 style="font-size: 28px; font-weight: 800; letter-spacing: -1px;">Apurv Vala</h2>
            <p style="color: var(--gray-400); font-weight: 700; font-size: 13px; margin-top: 5px;">nextge.bywala@gmail.com</p>
            <div style="display: inline-block; background: var(--primary); color: white; padding: 8px 24px; border-radius: 12px; font-size: 10px; font-weight: 800; margin-top: 20px; text-transform: uppercase; letter-spacing: 1.5px;">Authorized Identity</div>
        </div>
    </section>

    <!-- MOBILE NAV -->
    <div class="mobile-nav">
        <div class="m-nav-item active" id="m-shop" onclick="navigateTo('shop')">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>
            <span>Studio</span>
        </div>
        <div class="m-nav-item" id="m-orders" onclick="navigateTo('orders')">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2v20"/><path d="m17 5-5-3-5 3"/><path d="m17 19-5 3-5-3"/><path d="M2 7.15v9.7a2 2 0 0 0 1.15 1.8l7.45 3.5a2 2 0 0 0 1.8 0l7.45-3.5a2 2 0 0 0 1.15-1.8V7.15a2 2 0 0 0-1.15-1.8l-7.45-3.5a2 2 0 0 0-1.8 0l-7.45 3.5A2 2 0 0 0 2 7.15Z"/></svg>
            <span>Tracking</span>
        </div>
        <div class="m-nav-item" id="m-bag" onclick="navigateTo('bag')">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
            <span>Bag</span>
        </div>
        <div class="m-nav-item" id="m-profile" onclick="navigateTo('profile')">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            <span>Me</span>
        </div>
    </div>

    <div class="toast" id="toast">Update Sync</div>

    <script>
        // DEMO PRODUCTS (EACH WITH MULTIPLE HARDCODED IMAGES)
        const demoProducts = [
            { id: 101, name: "Pima Cotton Essential", category: "T-Shirt", price: 1899, stock: 12, color: "White", images: ["https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1562157873-818bc0726f68?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1554568218-0f1715e72254?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?auto=format&fit=crop&q=80&w=800"], desc: "High-density matrix cotton with a luxury silk-soft finish. Our most celebrated essential.", badge: "NEW" },
            { id: 102, name: "Oxford Button Down", category: "Shirt", price: 2499, stock: 8, color: "White", images: ["https://images.unsplash.com/photo-1596755094514-f87e34085b2c?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1621072156002-e2fccdc0b176?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1598911510795-7e944405908b?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1594932224828-b4b057b6d6ec?auto=format&fit=crop&q=80&w=800"], desc: "Crisp architectural cotton tailored for a refined silhouette. Office to evening seamless transition.", badge: "TOP-TIER" },
            { id: 103, name: "Heavyweight Boxy Tee", category: "T-Shirt", price: 1499, stock: 15, color: "Black", images: ["https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1586790170083-2f9ceadc732d?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1576566588028-4147f3842f27?auto=format&fit=crop&q=80&w=800"], desc: "Structural drop shoulder cut. Engineered for the modern urban explorer.", badge: "URBAN" },
            { id: 104, name: "Midnight Linen Layer", category: "Shirt", price: 3200, stock: 5, color: "Black", images: ["https://images.unsplash.com/photo-1602810318383-e386cc2a3ccf?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1603252109303-2751441dd157?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1607345366928-199e648ce8c8?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1594932224828-b4b057b6d6ec?auto=format&fit=crop&q=80&w=800"], desc: "Breathable Italian linen dyed in midnight obsidian. Luxury vacation pulse.", badge: "LIMITED" },
            { id: 105, name: "Vintage Striped Polo", category: "T-Shirt", price: 2199, stock: 10, color: "Olive", images: ["https://images.unsplash.com/photo-1586363104862-3a5e2ab60d99?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&fit=crop&q=80&w=800"], desc: "Retro-matrix vertical stripes with high-polish knit. A classic dream.", badge: "BESTSELLER" },
            { id: 106, name: "Pastel Sky Breezer", category: "Shirt", price: 2800, stock: 7, color: "Sky", images: ["https://images.unsplash.com/photo-1604691815944-6864f9cf17ab?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1596755094514-f87e34085b2c?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1596755094514-f87e34085b2c?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1596755094514-f87e34085b2c?auto=format&fit=crop&q=80&w=800"], desc: "Featherweight cotton poplin in dream-sky hues. Endless comfort.", badge: "CORE" },
            { id: 107, name: "Indigo Denim Utility", category: "Shirt", price: 3800, stock: 4, color: "Indigo", images: ["https://images.unsplash.com/photo-1589310243389-96a5483213a8?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1495121605193-b116b5b9c5fe?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1542838132-92c53300491e?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1550991152-12460a1618dd?auto=format&fit=crop&q=80&w=800"], desc: "Authentic indigo-dyed utility shirt. Built for the modern pioneer.", badge: "RUGGED" },
            { id: 108, name: "Sandwash Oversized Tee", category: "T-Shirt", price: 1100, stock: 20, color: "Sand", images: ["https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1489987707025-afc232f7ea0f?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1491336477066-31156b5e4f35?auto=format&fit=crop&q=80&w=800", "https://images.unsplash.com/photo-1491336477066-31156b5e4f35?auto=format&fit=crop&q=80&w=800"], desc: "Earthy pigment-dyed tee with a lived-in luxury feel. Street-ready.", badge: "VALUE" }
        ];

        let state = {
            products: JSON.parse(localStorage.getItem('sd_products')) || demoProducts,
            cart: JSON.parse(localStorage.getItem('sd_cart')) || [],
            orders: JSON.parse(localStorage.getItem('sd_orders')) || [
                { id: 'ORD-7721', productName: "Oxford Button Down", price: 2499, status: "Shipped", date: "2023-11-20", img: demoProducts[1].images[0] }
            ],
            filter: { category: 'All', price: 5000, color: 'All' },
            activeProduct: null,
            searchQuery: ''
        };

        function navigateTo(v) {
            document.querySelectorAll('.section-view').forEach(s => s.classList.add('hidden'));
            document.getElementById(v + '-view').classList.remove('hidden');
            document.querySelectorAll('.m-nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById('m-' + v)?.classList.add('active');
            if(v === 'shop') renderProducts();
            if(v === 'bag') renderBag();
            if(v === 'orders') renderOrders();
            window.scrollTo(0,0);
        }

        function toggleFilterPanel() { document.getElementById('filter-panel').classList.toggle('active'); }
        function updateRangeLabel(v) { document.getElementById('f-price-val').innerText = '₹' + v; }

        function setFilterType(t, el) {
            document.querySelectorAll('.filter-group button').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            state.filter.category = t;
        }

        function setFilterColor(c, el) {
            el.parentNode.querySelectorAll('.size-box').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            state.filter.color = c;
        }

        function handleSearch(q) {
            state.searchQuery = q.toLowerCase();
            applyFilterPulse();
        }

        function applyFilterPulse() {
            state.filter.price = parseInt(document.getElementById('f-price').value);
            let filtered = state.products.filter(p => {
                const matchPrice = p.price <= state.filter.price;
                const matchType = state.filter.category === 'All' || p.category === state.filter.category;
                const matchColor = state.filter.color === 'All' || p.color === state.filter.color;
                const matchSearch = p.name.toLowerCase().includes(state.searchQuery);
                return matchPrice && matchType && matchColor && matchSearch;
            });
            renderProducts(filtered);
            if(document.getElementById('filter-panel').classList.contains('active')) toggleFilterPanel();
        }

        function renderProducts(arr = state.products) {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = arr.map(p => `
                <div class="product-card reveal" onclick="viewDetail(${p.id})">
                    <div class="tag">${p.badge}</div>
                    <div class="card-img"><img src="${p.images[0]}" loading="lazy"></div>
                    <div class="card-info">
                        <h3>${p.name}</h3>
                        <p>${p.desc}</p>
                        <div class="price">₹${p.price}</div>
                    </div>
                </div>
            `).join('');
        }

        function viewDetail(id) {
            const p = state.products.find(x => x.id === id);
            state.activeProduct = p;
            const modal = document.getElementById('full-detail-modal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';

            document.getElementById('detail-content').innerHTML = `
                <div class="detail-layout">
                    <div class="gallery-side">
                        <div class="gallery-main"><img id="main-d-img" src="${p.images[0]}"></div>
                        <div class="gallery-thumbs">
                            ${p.images.map((img, i) => `<img src="${img}" class="thumb ${i==0?'active':''}" onclick="setDImg('${img}', this)">`).join('')}
                        </div>
                    </div>
                    <div class="info-pane">
                        <p style="font-size:11px; font-weight:800; color:var(--accent); text-transform:uppercase; margin-bottom:12px;">Premium ${p.category} Matrix</p>
                        <h1>${p.name}</h1>
                        <div class="detail-price">₹${p.price}</div>
                        <p class="detail-desc">${p.desc}</p>
                        <label style="font-size:11px; font-weight:800; margin-bottom:15px; display:block;">FIT SCALE</label>
                        <div class="size-grid">
                            <div class="size-box" onclick="selS(this)">S</div>
                            <div class="size-box active" onclick="selS(this)">M</div>
                            <div class="size-box" onclick="selS(this)">L</div>
                            <div class="size-box" onclick="selS(this)">XL</div>
                        </div>
                        <button class="add-btn-large" onclick="openCheckoutForm()">Transmit to Bag</button>
                    </div>
                </div>
            `;

            // Suggestions Grid
            const sug = state.products.filter(x => x.id !== id).slice(0, 4);
            document.getElementById('suggested-grid').innerHTML = sug.map(s => `
                <div class="product-card" onclick="viewDetail(${s.id})">
                    <div class="card-img"><img src="${s.images[0]}"></div>
                    <div class="card-info">
                        <h3>${s.name}</h3>
                        <div class="price">₹${s.price}</div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('checkout-section').style.display = 'none';
        }

        function closeDetail() { document.getElementById('full-detail-modal').style.display = 'none'; document.body.style.overflow = 'auto'; }
        function setDImg(s, e) { document.getElementById('main-d-img').src = s; document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active')); e.classList.add('active'); }
        function selS(e) { document.querySelectorAll('.size-box').forEach(b => b.classList.remove('active')); e.classList.add('active'); }

        function openCheckoutForm() {
            document.getElementById('checkout-section').style.display = 'block';
            document.getElementById('checkout-section').scrollIntoView({ behavior: 'smooth' });
        }

        document.getElementById('order-form').onsubmit = (e) => {
            e.preventDefault();
            const p = state.activeProduct;
            const newOrder = {
                id: 'ORD-' + Math.floor(Math.random()*9000+1000),
                productName: p.name,
                price: p.price,
                status: 'Ordered',
                date: new Date().toISOString().split('T')[0],
                img: p.images[0]
            };
            state.orders.unshift(newOrder);
            localStorage.setItem('sd_orders', JSON.stringify(state.orders));
            showToast('Transmission Successful');
            closeDetail();
            navigateTo('orders');
        };

        function renderBag() {
            const list = document.getElementById('bag-items');
            list.innerHTML = state.cart.length ? state.cart.map((i, idx) => `
                <div class="bag-item">
                    <img src="${i.images[0]}">
                    <div style="flex:1">
                        <h4 style="font-weight:800;">${i.name}</h4>
                        <p style="font-size:12px; color:var(--gray-400); margin-top:5px;">Size: ${i.selSize || 'M'} | Essential Matrix</p>
                        <div class="price" style="margin-top:10px;">₹${i.price}</div>
                        <button class="remove-btn" onclick="remBag(${idx})">PURGE</button>
                    </div>
                </div>
            `).join('') : '';
            document.getElementById('bag-empty').classList.toggle('hidden', state.cart.length > 0);
        }

        function remBag(i) { state.cart.splice(i, 1); localStorage.setItem('sd_cart', JSON.stringify(state.cart)); renderBag(); updateB(); }

        function renderOrders() {
            const list = document.getElementById('orders-list');
            list.innerHTML = state.orders.map(o => {
                const steps = ['Ordered', 'Confirmed', 'Shipped', 'Out for Delivery'];
                const idx = steps.indexOf(o.status || 'Ordered');
                const fill = (idx / (steps.length - 1)) * 100;
                return `
                    <div class="track-card">
                        <div class="flex" style="gap:20px; align-items:center;">
                            <img src="${o.img}" style="width:60px; height:75px; border-radius:14px; object-fit:cover;">
                            <div>
                                <p style="font-size:10px; font-weight:800; color:var(--gray-400);">${o.id}</p>
                                <h4 style="font-weight:800;">${o.productName}</h4>
                                <div class="price" style="font-size:15px; margin-top:4px;">₹${o.price}</div>
                            </div>
                        </div>
                        <div class="order-tracking-bar">
                            <div class="tracking-line"></div>
                            <div class="tracking-fill-bar" style="width: ${fill}%"></div>
                            ${steps.map((s, i) => `
                                <div class="flex flex-col items-center gap-2" style="position: relative; z-index: 10;">
                                    <div class="tracking-point ${i <= idx ? 'active' : ''}"></div>
                                    <span class="track-step ${i <= idx ? 'active' : ''}">${s}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateB() { document.getElementById('bag-count').innerText = state.cart.length; }
        function showToast(m) { const t = document.getElementById('toast'); t.innerText = m; t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 3000); }

        // Initial
        renderProducts();
        updateB();
    </script>
</body>
</html>
